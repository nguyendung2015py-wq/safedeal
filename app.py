iimport streamlit as st
import base64
import random
from datetime import datetime
from dataclasses import dataclass
from typing import List

st.set_page_config(
    page_title="SafeDeal ‚Äî —ç–∫—Å–ø–µ—Ä—Ç–∏–∑–∞ —Å–¥–µ–ª–∫–∏",
    layout="wide",
    initial_sidebar_state="collapsed",
)

def get_base64_image(image_path):
    try:
        with open(image_path, "rb") as img_file:
            return base64.b64encode(img_file.read()).decode()
    except Exception:
        return None

def inject_custom_styles() -> None:
    st.markdown(
        """
        <style>
        /* –£–ë–ò–í–ê–ï–ú –ö–û–†–û–ù–£ –ò –õ–ò–®–ù–ò–ô –ò–ù–¢–ï–†–§–ï–ô–° (–ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø –ó–ê–©–ò–¢–ê) */
        header {visibility: hidden !important;}
        footer {visibility: hidden !important; display: none !important;}
        #MainMenu {visibility: hidden !important; display: none !important;}
        [data-testid="stHeader"], [data-testid="stToolbar"], [data-testid="stDecoration"] { display: none !important; }
        
        /* –°–∫—Ä—ã–≤–∞–µ–º –∫—Ä–∞—Å–Ω—É—é –ø–ª–∞—à–∫—É Cloud */
        .viewerBadge_container, .viewerBadge_link, [data-testid="stViewerBadge"], .stDeployButton { 
            display: none !important; 
            visibility: hidden !important; 
            opacity: 0 !important; 
        }
        
        section[data-testid="stSidebar"], [data-testid="collapsedControl"] { display: none !important; }

        body { background-color: #ffffff; color: #2d3436; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Inter, sans-serif; }
        .main .block-container { padding-top: 2rem; max-width: 950px; }

        .header-wrapper { display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; width: 100%; margin-bottom: 2rem; }
        .logo-img { width: 140px; height: 140px; border-radius: 50%; object-fit: cover; box-shadow: 0 6px 15px rgba(0, 138, 94, 0.2); border: 4px solid #008a5e; padding: 3px; margin-bottom: 15px; }
        .hero-title { font-size: 2.2rem; font-weight: 900; color: #1e1e1e; margin: 0 0 5px 0; letter-spacing: 0.05em; }
        .hero-subtitle { font-size: 1.1rem; font-weight: 600; color: #008a5e; margin: 0 0 20px 0; }
        .custom-btn { background: linear-gradient(135deg, #008a5e 0%, #006f4b 100%); color: white !important; padding: 12px 35px; border-radius: 30px; font-weight: 600; font-size: 16px; text-decoration: none; box-shadow: 0 4px 15px rgba(0, 138, 94, 0.25); transition: 0.3s; display: inline-block; }
        .custom-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0, 138, 94, 0.35); }

        .stButton>button { background-color: #008a5e; color: #ffffff; border-radius: 8px; border: none; padding: 0.65rem 1.1rem; font-weight: 600; font-size: 0.9rem; width: 100%; margin-top: 10px; }
        .stButton>button:hover { background-color: #006f49; }
        .input-card { background-color: #ffffff; border-radius: 0.9rem; padding: 1.2rem; box-shadow: 0 10px 24px rgba(15, 23, 42, 0.05); border: 1px solid #e5e7eb; margin-top: 0.4rem; }

        .decision-banner { margin-top: 1.5rem; padding: 1.2rem; border-radius: 0.9rem; border: 1px solid; display: flex; align-items: center; gap: 1.5rem; }
        .decision-banner.danger { border-color: #dc2626; background: #fffcfc; }
        .decision-banner.warning { border-color: #f59e0b; background: #fffbeb; }
        .decision-banner.safe { border-color: #059669; background: #f8fffc; }
        
        .decision-score { font-size: 2.8rem; font-weight: 800; line-height: 1; }
        .danger .decision-score, .danger .decision-text-main { color: #dc2626; }
        .warning .decision-score, .warning .decision-text-main { color: #d97706; }
        .safe .decision-score, .safe .decision-text-main { color: #059669; }
        
        .decision-text-main { font-size: 1.1rem; font-weight: 700; text-transform: uppercase; }
        .decision-text-sub { font-size: 0.9rem; color: #4b5563; margin-top: 5px; }

        .table-wrapper { width: 100%; overflow-x: auto; margin-top: 1rem; border-radius: 8px; border: 1px solid #e5e7eb; }
        .risk-table { width: 100%; border-collapse: collapse; min-width: 600px; }
        .risk-table th { background-color: #f9fafb; font-weight: 700; padding: 12px; border-bottom: 2px solid #e5e7eb; text-align: left; font-size: 0.9rem; }
        .risk-table td { padding: 12px; border-bottom: 1px solid #e5e7eb; vertical-align: top; font-size: 0.85rem; line-height: 1.5; }
        .risk-table th:nth-child(1) { width: 20%; }
        .risk-table th:nth-child(2) { width: 45%; }
        .risk-table th:nth-child(3) { width: 35%; }
        
        .report-header { text-align: right; color: #6b7280; font-size: 0.8rem; font-weight: 600; margin-bottom: 10px; border-bottom: 1px dashed #e5e7eb; padding-bottom: 5px; }
        .footer-disclaimer { text-align: center; font-size: 0.75rem; color: #9ca3af; margin-top: 3rem; border-top: 1px solid #f3f4f6; padding-top: 1.5rem; line-height: 1.5; }

        @media (max-width: 768px) {
            .hero-title { font-size: 1.6rem; }
            .hero-subtitle { font-size: 0.95rem; }
            .logo-img { width: 110px; height: 110px; }
            .decision-banner { flex-direction: column; align-items: flex-start; gap: 0.8rem; padding: 1rem; }
            .decision-score { font-size: 2.2rem; }
            .risk-table th, .risk-table td { padding: 8px; font-size: 0.8rem; }
            .custom-btn { padding: 10px 25px; font-size: 14px; }
        }
        </style>
        """,
        unsafe_allow_html=True,
    )

@dataclass
class RiskItem:
    what: str; law: str; fix: str; weight: float; category: str

@dataclass
class AnalysisResult:
    total_risk: int; items: List[RiskItem]

def _detect(text: str, keywords: List[str]) -> bool:
    return any(kw in text.lower() for kw in keywords)

def analyze_safedeal(text: str) -> AnalysisResult:
    items = []
    
    risks = [
        {"cat": "object", "what": "–û–±—ä–µ–∫—Ç –≤ –∑–∞–ª–æ–≥–µ (–∏–ø–æ—Ç–µ–∫–∞ –±–∞–Ω–∫–∞)", 
         "kw": ["–≤ –∏–ø–æ—Ç–µ–∫–µ", "–∑–∞–ª–æ–≥", "–æ–±—Ä–µ–º–µ–Ω–µ–Ω", "–ø–æ–¥ –∑–∞–ª–æ–≥–æ–º", "–∏–ø–æ—Ç–µ—á–Ω", "–≤ —Å–∏–ª—É –∑–∞–∫–æ–Ω–∞"], 
         "law": "<b>–§–ó ‚Ññ102-–§–ó ¬´–û–± –∏–ø–æ—Ç–µ–∫–µ¬ª —Å—Ç. 37.</b> –û—Ç—á—É–∂–¥–µ–Ω–∏–µ –∑–∞–ª–æ–∂–µ–Ω–Ω–æ–≥–æ –∏–º—É—â–µ—Å—Ç–≤–∞ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å –ø–∏—Å—å–º–µ–Ω–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–∏—è –∑–∞–ª–æ–≥–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—è. –°–¥–µ–ª–∫–∞ –±–µ–∑ —Å–æ–≥–ª–∞—Å–∏—è –Ω–∏—á—Ç–æ–∂–Ω–∞.", 
         "fix": "–ü—Ä–æ–≤–æ–¥–∏—Ç—å —Å–¥–µ–ª–∫—É —Å—Ç—Ä–æ–≥–æ –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –±–∞–Ω–∫–∞-–∑–∞–ª–æ–≥–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—è: –≥–∞—à–µ–Ω–∏–µ –¥–æ–ª–≥–∞ –≤ —Ö–æ–¥–µ —Å–¥–µ–ª–∫–∏ —á–µ—Ä–µ–∑ –°–ë–† –∏–ª–∏ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ –¥–æ–ª–≥–∞.", "w": 15.0},
        
        {"cat": "object", "what": "–ê—Ä–µ—Å—Ç –∏–ª–∏ –∑–∞–ø—Ä–µ—Ç –Ω–∞ —Ä–µ–≥. –¥–µ–π—Å—Ç–≤–∏—è", 
         "kw": ["–∞—Ä–µ—Å—Ç", "–∑–∞–ø—Ä–µ—Ç", "–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏", "—Å—É–¥–µ–±–Ω—ã–π –ø—Ä–∏—Å—Ç–∞–≤"], 
         "law": "<b>–§–ó ‚Ññ218-–§–ó ¬´–û –≥–æ—Å—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏¬ª —Å—Ç. 56.</b> –†–æ—Å—Ä–µ–µ—Å—Ç—Ä –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç –∏ –æ—Ç–∫–∞–∂–µ—Ç –≤ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø—Ä–∞–≤–∞. –°–¥–µ–ª–∫–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –¥–æ —Å–Ω—è—Ç–∏—è –∑–∞–ø—Ä–µ—Ç–∞ –∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä–æ–º (—Å—É–¥, –§–°–°–ü).", 
         "fix": "–°—Ä–æ—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –≤—ã–ø–∏—Å–∫–∏ –ï–ì–†–ù. –ü–æ–≥–∞—à–µ–Ω–∏–µ –¥–æ–ª–≥–æ–≤ –ø—Ä–æ–¥–∞–≤—Ü–æ–º –¥–æ —Å–¥–µ–ª–∫–∏ —Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –ø–æ–ª—É—á–µ–Ω–∏–µ–º –ø–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –æ —Å–Ω—è—Ç–∏–∏ –∞—Ä–µ—Å—Ç–∞.", "w": 30.0},
        
        {"cat": "object", "what": "–ú–∞—Ç–∫–∞–ø–∏—Ç–∞–ª –∏ —Å–∫—Ä—ã—Ç—ã–µ –¥–µ—Ç—Å–∫–∏–µ –¥–æ–ª–∏", 
         "kw": ["–º–∞—Ç–∫–∞–ø–∏—Ç–∞–ª", "–º–∞—Ç–µ—Ä–∏–Ω—Å–∫", "–¥–µ—Ç—Å–∫", "–¥–æ–ª–∏ –Ω–µ –≤—ã–¥–µ–ª–µ–Ω—ã", "–æ–ø–µ–∫", "–Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–Ω"], 
         "law": "<b>–°–ö –†–§ —Å—Ç. 60, –§–ó ‚Ññ 256-–§–ó (—á. 4 —Å—Ç. 10).</b> –°–¥–µ–ª–∫–∞ –±–µ–∑ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã–¥–µ–ª–µ–Ω–∏—è –¥–æ–ª–µ–π –¥–µ—Ç—è–º –Ω–∏—á—Ç–æ–∂–Ω–∞ (—Å—Ç. 168 –ì–ö –†–§). –†–∏—Å–∫ —Ä–∞—Å—Ç–æ—Ä–∂–µ–Ω–∏—è —Å–¥–µ–ª–∫–∏ –æ–ø–µ–∫–æ–π –∏–ª–∏ –ø—Ä–æ–∫—É—Ä–∞—Ç—É—Ä–æ–π.", 
         "fix": "–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å–ø—Ä–∞–≤–∫–∏ –æ–± –æ—Å—Ç–∞—Ç–∫–µ –º–∞—Ç–∫–∞–ø–∏—Ç–∞–ª–∞ –∏–∑ –°–§–†. –¢—Ä–µ–±–æ–≤–∞—Ç—å –Ω–æ—Ç–∞—Ä–∏–∞–ª—å–Ω–æ–≥–æ –≤—ã–¥–µ–ª–µ–Ω–∏—è –¥–æ–ª–µ–π –¥–æ —Å–¥–µ–ª–∫–∏ –∏ –ø—Ä–∏–∫–∞–∑ –æ–ø–µ–∫–∏.", "w": 20.0},
        
        {"cat": "object", "what": "–°–≤–µ–∂–µ–µ –∏–ª–∏ —Å–ø–æ—Ä–Ω–æ–µ –Ω–∞—Å–ª–µ–¥—Å—Ç–≤–æ", 
         "kw": ["–Ω–∞—Å–ª–µ–¥—Å—Ç–≤", "–∑–∞–≤–µ—â–∞–Ω", "—Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –æ –ø—Ä–∞–≤–µ", "—É–º–µ—Ä", "–≤—Å—Ç—É–ø–∏–ª –≤ –Ω–∞—Å–ª–µ–¥—Å—Ç–≤–æ"], 
         "law": "<b>–ì–ö –†–§ —Å—Ç. 1149, —Å—Ç. 1155.</b> –ü–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ü–ª–µ–Ω—É–º–∞ –í–° –†–§ ‚Ññ 9. –û–±—ä—è–≤–ª–µ–Ω–∏–µ –≤–Ω–µ–±—Ä–∞—á–Ω—ã—Ö –¥–µ—Ç–µ–π –∏–ª–∏ –ª–∏—Ü, –Ω–µ –∑–Ω–∞–≤—à–∏—Ö –æ —Å–º–µ—Ä—Ç–∏, –≤–µ–¥–µ—Ç –∫ –∏—Å—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é –¥–æ–ª–∏ –∏–∑ –Ω–µ–∑–∞–∫–æ–Ω–Ω–æ–≥–æ –≤–ª–∞–¥–µ–Ω–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—è (—Å—Ç. 302 –ì–ö –†–§).", 
         "fix": "–í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ –ø—Ä–∏ –Ω–∞—Å–ª–µ–¥—Å—Ç–≤–µ –¥–æ 3 –ª–µ—Ç. –¢—Ä–µ–±–æ–≤–∞—Ç—å –æ—Ç –ø—Ä–æ–¥–∞–≤—Ü–∞ –Ω–æ—Ç–∞—Ä–∏–∞–ª—å–Ω–æ–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –æ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–º —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–º —É—Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–µ—Ç–µ–Ω–∑–∏–π.", "w": 20.0},

        {"cat": "object", "what": "–ü—Ä–∏–≤–∞—Ç–∏–∑–∞—Ü–∏—è –∏ —Å–∫—Ä—ã—Ç—ã–µ ¬´–æ—Ç–∫–∞–∑–Ω–∏–∫–∏¬ª", 
         "kw": ["–ø—Ä–∏–≤–∞—Ç–∏–∑–∞", "—Å–æ—Ü–Ω–∞–π–º", "–æ—Ä–¥–µ—Ä", "–æ—Ç–∫–∞–∑–Ω–∏–∫", "–æ—Ç–∫–∞–∑–∞–ª—Å—è –æ—Ç —É—á–∞—Å—Ç–∏—è"], 
         "law": "<b>–ì–ö –†–§ —Å—Ç. 292, –ñ–ö –†–§ —Å—Ç. 31. –§–ó ‚Ññ 189-–§–ó (—Å—Ç. 19).</b> –õ–∏—Ü–∞, –æ—Ç–∫–∞–∑–∞–≤—à–∏–µ—Å—è –æ—Ç —É—á–∞—Å—Ç–∏—è –≤ –ø—Ä–∏–≤–∞—Ç–∏–∑–∞—Ü–∏–∏, –ø—Ä–∏–æ–±—Ä–µ—Ç–∞—é—Ç –±–µ—Å—Å—Ä–æ—á–Ω–æ–µ –ø—Ä–∞–≤–æ –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–æ–º–µ—â–µ–Ω–∏–µ–º. –í—ã—Å–µ–ª–∏—Ç—å –∏—Ö —á–µ—Ä–µ–∑ —Å—É–¥ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ.", 
         "fix": "–ó–∞–ø—Ä–æ—Å –∞—Ä—Ö–∏–≤–Ω–æ–π –≤—ã–ø–∏—Å–∫–∏ –∏–∑ –¥–æ–º–æ–≤–æ–π –∫–Ω–∏–≥–∏. –¢—Ä–µ–±–æ–≤–∞—Ç—å —Å–Ω—è—Ç–∏—è —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —É—á–µ—Ç–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–æ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –î–ö–ü.", "w": 15.0},

        {"cat": "object", "what": "–î–æ–≥–æ–≤–æ—Ä —Ä–µ–Ω—Ç—ã / –ü–æ–∂–∏–∑–Ω–µ–Ω–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ", 
         "kw": ["—Ä–µ–Ω—Ç", "–ø–æ–∂–∏–∑–Ω–µ–Ω–Ω", "–∏–∂–¥–∏–≤–µ–Ω–∏", "—Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å –∏–∂–¥–∏–≤–µ–Ω–∏–µ–º"], 
         "law": "<b>–ì–ö –†–§ —Å—Ç. 599, 605.</b> –ü–æ–ª—É—á–∞—Ç–µ–ª—å —Ä–µ–Ω—Ç—ã –º–æ–∂–µ—Ç –∑–∞—è–≤–∏—Ç—å –æ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–º –Ω–∞—Ä—É—à–µ–Ω–∏–∏ —É—Å–ª–æ–≤–∏–π –¥–æ–≥–æ–≤–æ—Ä–∞ –∏ –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫–≤–∞—Ä—Ç–∏—Ä—ã. –†–∏—Å–∫ –æ—Å–ø–∞—Ä–∏–≤–∞–Ω–∏—è —Å–¥–µ–ª–∫–∏ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∞–º–∏.", 
         "fix": "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–∫—Ç–∞ —Å–Ω—è—Ç–∏—è –æ–±—Ä–µ–º–µ–Ω–µ–Ω–∏—è. –ï—Å–ª–∏ —Ä–µ–Ω—Ç–æ–ø–æ–ª—É—á–∞—Ç–µ–ª—å –∂–∏–≤ ‚Äî —Å–¥–µ–ª–∫–∞ —Ç–æ–ª—å–∫–æ —Å –µ–≥–æ –Ω–æ—Ç–∞—Ä–∏–∞–ª—å–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–∏—è. –ò–∑—É—á–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∫–∏ –æ –ø–ª–∞—Ç–µ–∂–∞—Ö.", "w": 20.0},

        {"cat": "object", "what": "–ö–æ—Ä–æ—Ç–∫–∏–π —Å—Ä–æ–∫ –≤–ª–∞–¥–µ–Ω–∏—è", 
         "kw": ["—á–∞—Å—Ç–∞—è —Å–º–µ–Ω–∞", "–ø–µ—Ä–µ–ø—Ä–æ–¥–∞–≤–∞–ª–∞—Å—å", "–≥–æ–¥ –Ω–∞–∑–∞–¥", "–≤–ª–∞–¥–µ–µ—Ç –≤—Å–µ–≥–æ", "–≤–ª–∞–¥–µ–µ—Ç –≥–æ–¥", "–º–µ–Ω–µ–µ 3 –ª–µ—Ç", "–º–µ–Ω–µ–µ 5 –ª–µ—Ç"], 
         "law": "<b>–ì–ö –†–§ —Å—Ç. 170. –§–ó ‚Ññ 127-–§–ó —Å—Ç. 61.2.</b> –ë—ã—Å—Ç—Ä–∞—è –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–∞ ‚Äî –º–∞—Ä–∫–µ—Ä —Å–æ–∫—Ä—ã—Ç–∏—è –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞ –∏–ª–∏ –ø—Ä–µ–¥–±–∞–Ω–∫—Ä–æ—Ç–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ –∞–∫—Ç–∏–≤–æ–≤. –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç–∫–∞—Ç–∞ —Ü–µ–ø–æ—á–∫–∏ —Å–¥–µ–ª–æ–∫.", 
         "fix": "–ó–∞–ø—Ä–æ—Å –≤—ã–ø–∏—Å–∫–∏ –ï–ì–†–ù –æ –ø–µ—Ä–µ—Ö–æ–¥–µ –ø—Ä–∞–≤. –ì–ª—É–±–æ–∫–∞—è –ø—Ä–∞–≤–æ–≤–∞—è —ç–∫—Å–ø–µ—Ä—Ç–∏–∑–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–π –∫–∞–∂–¥–æ–π —Å–¥–µ–ª–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –≥–æ–¥–∞.", "w": 15.0},

        {"cat": "object", "what": "–ù–µ–∑–∞–∫–æ–Ω–Ω–∞—è –ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∞", 
         "kw": ["–ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤", "—É–∑–∞–∫–æ–Ω–µ–Ω", "–Ω–µ—Å—É—â", "–º–æ–∫—Ä", "–ø–µ—Ä–µ—É—Å—Ç—Ä–æ–π—Å—Ç–≤", "–ø–µ—Ä–µ–Ω–æ—Å"], 
         "law": "<b>–ñ–ö –†–§ —Å—Ç. 29. –ö–æ–ê–ü –†–§ —Å—Ç. 7.21.</b> –í—Å—è –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ –Ω–µ–∑–∞–∫–æ–Ω–Ω—É—é –ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∫—É –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –Ω–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è.", 
         "fix": "–í–∏–∑—É–∞–ª—å–Ω–∞—è —Å–≤–µ—Ä–∫–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–≤–∞—Ä—Ç–∏—Ä—ã —Å –ø–ª–∞–Ω–æ–º –ë–¢–ò.", "w": 10.0},

        {"cat": "seller", "what": "–ë–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ, –¥–æ–ª–≥–∏ –∏ —Å—É–¥—ã", 
         "kw": ["–±–∞–Ω–∫—Ä–æ—Ç", "–ø—Ä–∏—Å—Ç–∞–≤", "–¥–æ–ª–≥", "—Ñ—Å—Å–ø", "—Å—É–¥–µ–±–Ω", "–Ω–∏–∂–µ —Ä—ã–Ω–∫–∞", "—Å—Ä–æ—á–Ω–æ –ø—Ä–æ–¥–∞–º", "–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω"], 
         "law": "<b>–§–ó ‚Ññ 127-–§–ó ¬´–û –Ω–µ—Å–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–µ)¬ª —Å—Ç. 61.2.</b> –°–¥–µ–ª–∫–∏ –¥–æ–ª–∂–Ω–∏–∫–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 3 –ª–µ—Ç –¥–æ –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–∞ –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Å–ø–æ—Ä–µ–Ω—ã. –ö–≤–∞—Ä—Ç–∏—Ä–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –∫–æ–Ω–∫—É—Ä—Å–Ω—É—é –º–∞—Å—Å—É.", 
         "fix": "–ê—É–¥–∏—Ç –ø—Ä–æ–¥–∞–≤—Ü–∞ (–∏ –µ–≥–æ —Å—É–ø—Ä—É–≥–∞) –ø–æ –±–∞–∑–∞–º –§–°–°–ü, –ï–§–†–°–ë, –∫–∞—Ä—Ç–æ—Ç–µ–∫–µ –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã—Ö –¥–µ–ª (–ö–ê–î) –∏ –ì–ê–° ¬´–ü—Ä–∞–≤–æ—Å—É–¥–∏–µ¬ª.", "w": 25.0},

        {"cat": "seller", "what": "–°–ø—Ä–∞–≤–∫–∏ –ü–ù–î/–ù–î –∏ –¥–µ–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å", 
         "kw": ["–ø–µ–Ω—Å–∏–æ–Ω–µ—Ä", "–ø–æ–∂–∏–ª", "–∏–Ω–≤–∞–ª–∏–¥", "–ø—Å–∏—Ö–∏–∞—Ç—Ä", "–Ω–∞—Ä–∫–æ–ª–æ–≥", "–ø–Ω–¥", "–Ω–¥", "—Å–ø—Ä–∞–≤–∫", "—Å–æ—Å—Ç–æ–∏—Ç –Ω–∞ —É—á–µ—Ç–µ", "–¥–µ–µ—Å–ø–æ—Å–æ–±–Ω"], 
         "law": "<b>–ì–ö –†–§ —Å—Ç. 177.</b> –°–¥–µ–ª–∫–∞, —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–∞—è –≥—Ä–∞–∂–¥–∞–Ω–∏–Ω–æ–º, –Ω–µ —Å–ø–æ—Å–æ–±–Ω—ã–º –ø–æ–Ω–∏–º–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —Å–≤–æ–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π, –æ—Å–ø–æ—Ä–∏–º–∞.", 
         "fix": "–¢—Ä–µ–±–æ–≤–∞—Ç—å –ª–∏—á–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø—Ä–∞–≤–æ–∫ –∏–∑ –ü–ù–î –∏ –ù–î –ø—Ä–æ–¥–∞–≤—Ü–æ–º. –û–ø—Ç–∏–º–∞–ª—å–Ω–æ ‚Äî –æ—Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –≤—Ä–∞—á–æ–º-–ø—Å–∏—Ö–∏–∞—Ç—Ä–æ–º –Ω–∞ —Å–¥–µ–ª–∫–µ.", "w": 20.0},

        {"cat": "seller", "what": "–°–æ–≤–º–µ—Å—Ç–Ω–æ –Ω–∞–∂–∏—Ç–æ–µ –∏–º—É—â–µ—Å—Ç–≤–æ (–°—É–ø—Ä—É–≥–∏)", 
         "kw": ["–±—Ä–∞–∫", "–∂–µ–Ω–∞—Ç", "–∑–∞–º—É–∂–µ–º", "—Å—É–ø—Ä—É–≥", "—Ä–∞–∑–≤–æ–¥", "—Å–æ–≤–º–µ—Å—Ç–Ω"], 
         "law": "<b>–°–ö –†–§ —Å—Ç. 35 —á. 3. –ì–ö –†–§ —Å—Ç. 253.</b> –î–ª—è –ø—Ä–æ–¥–∞–∂–∏ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏, –∫—É–ø–ª–µ–Ω–Ω–æ–π –≤ –±—Ä–∞–∫–µ, —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–æ—Ç–∞—Ä–∏–∞–ª—å–Ω–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ —Å—É–ø—Ä—É–≥–∞.", 
         "fix": "–ü—Ä–æ–≤–µ—Ä–∫–∞ —à—Ç–∞–º–ø–æ–≤ –≤ –ø–∞—Å–ø–æ—Ä—Ç–µ –∏ —Å–ø—Ä–∞–≤–æ–∫ –∏–∑ –ó–ê–ì–°–∞. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –Ω–æ—Ç–∞—Ä–∏–∞–ª—å–Ω–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ —Å—É–ø—Ä—É–≥–∞ (–¥–∞–∂–µ –±—ã–≤—à–µ–≥–æ) –∏–ª–∏ –±—Ä–∞—á–Ω—ã–π –¥–æ–≥–æ–≤–æ—Ä.", "w": 15.0},

        {"cat": "seller", "what": "–ü—Ä–æ–¥–∞–∂–∞ –ø–æ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏", 
         "kw": ["–¥–æ–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç", "–ø–æ–≤–µ—Ä–µ–Ω–Ω", "–ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª", "–∑–∞ –≥—Ä–∞–Ω–∏—Ü–µ–π"], 
         "law": "<b>–ì–ö –†–§ —Å—Ç. 188.</b> –°–¥–µ–ª–∫–∞ –Ω–∏—á—Ç–æ–∂–Ω–∞, –µ—Å–ª–∏ –Ω–∞ –º–æ–º–µ–Ω—Ç –µ–µ —Å–æ–≤–µ—Ä—à–µ–Ω–∏—è –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å —É–º–µ—Ä, –ø—Ä–∏–∑–Ω–∞–Ω –Ω–µ–¥–µ–µ—Å–ø–æ—Å–æ–±–Ω—ã–º –∏–ª–∏ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –æ—Ç–æ–∑–≤–∞–Ω–∞.", 
         "fix": "–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ —Ä–µ–µ—Å—Ç—Ä—É –§–ù–ü –ø—Ä—è–º–æ –≤ –¥–µ–Ω—å —Å–¥–µ–ª–∫–∏. –ù–∞—Å—Ç–∞–∏–≤–∞—Ç—å –Ω–∞ –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–º.", "w": 20.0},

        {"cat": "seller", "what": "–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞—Å–ø–æ—Ä—Ç", 
         "kw": ["–ø–∞—Å–ø–æ—Ä—Ç", "—É—Ç–µ—Ä—è", "–∑–∞–º–µ–Ω", "–ø–æ–¥–¥–µ–ª"], 
         "law": "<b>–ì–ö –†–§ —Å—Ç. 179. –£–ö –†–§ —Å—Ç. 159.</b> –°–¥–µ–ª–∫–∞, —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–∞—è –Ω–µ—É–ø–æ–ª–Ω–æ–º–æ—á–µ–Ω–Ω—ã–º –ª–∏—Ü–æ–º –ø–æ –ø–æ–¥–ª–æ–∂–Ω—ã–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º, –Ω–µ –≤–ª–µ—á–µ—Ç —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π.", 
         "fix": "–°–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–∞—Å–ø–æ—Ä—Ç–∞ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º —Å–ø–∏—Å–∫–æ–º –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Å–ø–æ—Ä—Ç–æ–≤ –ú–í–î –†–æ—Å—Å–∏–∏.", "w": 20.0},

        {"cat": "trigger", "what": "–ó–∞–Ω–∏–∂–µ–Ω–∏–µ —Ü–µ–Ω—ã –≤ –¥–æ–≥–æ–≤–æ—Ä–µ (–î–ö–ü)", 
         "kw": ["–∑–∞–Ω–∏–∂–µ–Ω", "–≤ –∫–æ–Ω–≤–µ—Ä—Ç–µ", "–º–µ–Ω—å—à–µ", "–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è", "–Ω–µ–ø–æ–ª–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç", "–Ω–∞–ª–æ–≥", "–æ—Å—Ç–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–¥–∞–¥–∏—Ç–µ"], 
         "law": "<b>–ì–ö –†–§ —Å—Ç. 170</b> (–ü—Ä–∏—Ç–≤–æ—Ä–Ω–∞—è —Å–¥–µ–ª–∫–∞). <b>–ù–ö –†–§ —Å—Ç. 122.</b> –ü—Ä–∏ –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–µ –ø—Ä–æ–¥–∞–≤—Ü–∞ —Å—É–¥ –∑–∞—Å—Ç–∞–≤–∏—Ç –≤–µ—Ä–Ω—É—Ç—å –∫–≤–∞—Ä—Ç–∏—Ä—É, –∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—é –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—Ç –ª–∏—à—å —Å—É–º–º—É –∏–∑ –î–ö–ü.", 
         "fix": "–£–∫–∞–∑—ã–≤–∞—Ç—å –≤ –î–ö–ü –ø–æ–ª–Ω—É—é —Ä–µ–∞–ª—å–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–∫–∫—Ä–µ–¥–∏—Ç–∏–≤ –∏–ª–∏ —ç—Å–∫—Ä–æ—É-—Å—á–µ—Ç.", "w": 30.0},

        {"cat": "trigger", "what": "–í—Å—Ç—Ä–µ—á–Ω–∞—è / –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Å–¥–µ–ª–∫–∞", 
         "kw": ["–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤", "–≤—Å—Ç—Ä–µ—á–Ω", "—Ü–µ–ø–æ—á–∫", "–æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω", "–ø–æ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–º"], 
         "law": "<b>–ì–ö –†–§ —Å—Ç. 157.</b> –†–∏—Å–∫ —Ä–∞–∑–≤–∞–ª–∞ –≤—Å–µ–π —Ü–µ–ø–∏ —Å–¥–µ–ª–æ–∫ –∏–∑-–∑–∞ —Å—Ä—ã–≤–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏–ª–∏ –æ—Ç–∫–∞–∑–∞ –æ–¥–Ω–æ–≥–æ –∏–∑ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.", 
         "fix": "–¢—â–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –í–°–ï–• –æ–±—ä–µ–∫—Ç–æ–≤ –≤ —Ü–µ–ø–æ—á–∫–µ. –ï–¥–∏–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–æ–¥–∞—á–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é.", "w": 10.0},

        {"cat": "trigger", "what": "–û—Ç–∫–∞–∑ –æ—Ç –∏–ø–æ—Ç–µ–∫–∏", 
         "kw": ["–±–µ–∑ –∏–ø–æ—Ç–µ–∫–∏", "—Ç–æ–ª—å–∫–æ –Ω–∞–ª–∏—á–Ω—ã"], 
         "law": "–ü—Ä–æ–¥–∞–≤–µ—Ü –∏–∑–±–µ–≥–∞–µ—Ç –±–∞–Ω–∫–æ–≤—Å–∫–æ–≥–æ –∞–Ω–¥–µ—Ä—Ä–∞–π—Ç–∏–Ω–≥–∞, —Ç–∞–∫ –∫–∞–∫ –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–µ –≤—ã–¥–µ—Ä–∂–∞—Ç —ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã.", 
         "fix": "–¢—Ä–µ–±–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ —ç–∫—Å–ø–µ—Ä—Ç–Ω–æ–≥–æ –∞—É–¥–∏—Ç–∞ —Å–¥–µ–ª–∫–∏.", "w": 15.0},

        {"cat": "trigger", "what": "–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—Ç–∫–∞ –≤—Å–ª–µ–ø—É—é", 
         "kw": ["–∑–∞–¥–∞—Ç–æ–∫ –¥–æ", "–∞–≤–∞–Ω—Å –¥–æ", "–ø—Ä–µ–¥–æ–ø–ª–∞—Ç–∞", "—á—Ç–æ–±—ã –∑–∞–∫—Ä–µ–ø–∏—Ç—å"], 
         "law": "<b>–ì–ö –†–§ —Å—Ç. 380, —Å—Ç. 381.</b> –ï—Å–ª–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–∫–∞–∂–µ—Ç—Å—è –æ—Ç —Å–¥–µ–ª–∫–∏, –ø—Ä–æ–¥–∞–≤–µ—Ü —é—Ä–∏–¥–∏—á–µ—Å–∫–∏ –≤–ø—Ä–∞–≤–µ —É–¥–µ—Ä–∂–∞—Ç—å –∑–∞–¥–∞—Ç–æ–∫.", 
         "fix": "–ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è –æ–± –∞–≤–∞–Ω—Å–µ (—Å —É—Å–ª–æ–≤–∏–µ–º –≤–æ–∑–≤—Ä–∞—Ç–∞) —Ç–æ–ª—å–∫–æ –ü–û–°–õ–ï –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ –ø–∞–∫–µ—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.", "w": 15.0},
    ]

    for cfg in risks:
        if _detect(text, cfg["kw"]):
            items.append(RiskItem(cfg["what"], cfg["law"], cfg["fix"], cfg["w"], cfg["cat"]))

    b_tot = sum(i.weight for i in items)
    
    critical_triggers = ["–≤ –∫–æ–Ω–≤–µ—Ä—Ç–µ", "–∑–∞–Ω–∏–∂–µ–Ω", "–º–µ–Ω—å—à–µ", "–±–∞–Ω–∫—Ä–æ—Ç", "—Å—É–¥–µ–±–Ω", "–Ω–∞—Å–ª–µ–¥—Å—Ç–≤", "–∑–∞–≤–µ—â–∞–Ω", "–¥–æ–ª–∏ –Ω–µ –≤—ã–¥–µ–ª–µ–Ω—ã", "–æ–ø–µ–∫", "–∞—Ä–µ—Å—Ç", "–∑–∞–ø—Ä–µ—Ç"]
    if _detect(text, critical_triggers):
        b_tot = max(b_tot, 85.0)

    if not items:
        b_tot = 40.0
        items.append(RiskItem("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞", "<b>–ì–ö –†–§ —Å—Ç. 421</b> (–°–≤–æ–±–æ–¥–∞ –¥–æ–≥–æ–≤–æ—Ä–∞). –í —Ç–µ–∫—Å—Ç–µ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ —è–≤–Ω—ã—Ö —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –º–∞—Ä–∫–µ—Ä–æ–≤. –û–¥–Ω–∞–∫–æ —ç—Ç–æ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —á–∏—Å—Ç–æ—Ç—É —Å–¥–µ–ª–∫–∏.", "–ü—Ä–æ–≤–µ–¥–∏—Ç–µ —Å–±–æ—Ä –ø–æ–ª–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤: –ï–ì–†–ù, –¥–æ–∫—É–º–µ–Ω—Ç—ã-–æ—Å–Ω–æ–≤–∞–Ω–∏—è, —Å–ø—Ä–∞–≤–∫–∏ –æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—è—Ö.", 40.0, "object"))

    final_score = max(0, min(int(round(b_tot)), 100))
    return AnalysisResult(final_score, items)

def main():
    inject_custom_styles()

    logo_b64 = get_base64_image("logo.png")
    if logo_b64:
        logo_html = f'<img src="data:image/png;base64,{logo_b64}" class="logo-img">'
    else:
        logo_html = "<div style='font-size:50px; margin-bottom:15px;'>üè¢</div>"

    st.markdown(f"""
        <div class="header-wrapper">
            {logo_html}
            <div class="hero-title">–ê–†–¢–ï–ú –ù–û–°–û–í | –†–ò–ï–õ–¢–û–†</div>
            <div class="hero-subtitle">–ê–≤—Ç–æ—Ä—Å–∫–∏–π —Å–µ—Ä–≤–∏—Å –∞—É–¥–∏—Ç–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏</div>
            <a href="https://t.me/nosov_s_blog" class="custom-btn" target="_blank">üëâ –ü–ï–†–ï–ô–¢–ò –í –ë–õ–û–ì ¬´–ü–£–¢–¨ –ë–ï–ó –§–ê–õ–¨–®–ò¬ª</a>
        </div>
    """, unsafe_allow_html=True)

    st.markdown('<div class="input-card">', unsafe_allow_html=True)
    text = st.text_area("–¢–µ–∫—Å—Ç –¥–ª—è —ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã", height=160, placeholder="–û–ø–∏—à–∏—Ç–µ —Å–∏—Ç—É–∞—Ü–∏—é. –ù–∞–ø—Ä–∏–º–µ—Ä: '–ö–≤–∞—Ä—Ç–∏—Ä–∞ –≤ –∏–ø–æ—Ç–µ–∫–µ, –¥–æ–ª–∏ –¥–µ—Ç—è–º –Ω–µ –≤—ã–¥–µ–ª–µ–Ω—ã. –•–æ—Ç—è—Ç –∑–∞–Ω–∏–∂–µ–Ω–∏–µ —Ü–µ–Ω—ã. –ü—Ä–æ–¥–∞–µ—Ç –ø–µ–Ω—Å–∏–æ–Ω–µ—Ä –ø–æ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏...'")
    
    if st.button("–ó–ê–ü–£–°–¢–ò–¢–¨ –ì–õ–£–ë–û–ö–£–Æ –≠–ö–°–ü–ï–†–¢–ò–ó–£"):
        if not text.strip(): 
            st.warning("–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.")
        else:
            res = analyze_safedeal(text)
            
            if res.total_risk >= 70:
                b_cls = "danger"
                z_lbl = "–ö–†–ê–°–ù–ê–Ø –ó–û–ù–ê (–°–¢–û–ü-–°–î–ï–õ–ö–ê)"
                sub_txt = "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞. –ó–∞–ø—Ä–µ—â–µ–Ω–æ –≤—ã—Ö–æ–¥–∏—Ç—å –Ω–∞ —Å–¥–µ–ª–∫—É –±–µ–∑ –ø—Ä–æ—Ñ–∏–ª—å–Ω–æ–≥–æ —é—Ä–∏—Å—Ç–∞."
            elif res.total_risk >= 40:
                b_cls = "warning"
                z_lbl = "–ñ–ï–õ–¢–ê–Ø –ó–û–ù–ê (–ü–û–í–´–®–ï–ù–ù–´–ô –†–ò–°–ö)"
                sub_txt = "–¢—Ä–µ–±—É–µ—Ç—Å—è —Å–±–æ—Ä –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ –≥–ª—É–±–æ–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤."
            else:
                b_cls = "safe"
                z_lbl = "–ó–ï–õ–ï–ù–ê–Ø –ó–û–ù–ê (–ö–û–ù–¢–†–û–õ–ò–†–£–ï–ú–û)"
                sub_txt = "–Ø–≤–Ω—ã—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É–≥—Ä–æ–∑ –Ω–µ –≤—ã—è–≤–ª–µ–Ω–æ, –Ω–æ –±–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞."
            
            report_id = random.randint(10000, 99999)
            current_date = datetime.now().strftime('%d.%m.%Y %H:%M')
            
            st.markdown(f"""
            <div class="decision-banner {b_cls}">
                <div style="text-align: center; min-width: 120px;">
                    <div class="decision-score">{res.total_risk}%</div>
                    <div style="font-size: 0.8rem; font-weight: bold; color: #6b7280; margin-top: 5px;">–ò–ù–î–ï–ö–° –†–ò–°–ö–ê</div>
                </div>
                <div style="width: 100%;">
                    <div class="report-header">–ê–∫—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ ‚Ññ{report_id} –æ—Ç {current_date}</div>
                    <div class="decision-text-main">{z_lbl}</div>
                    <div class="decision-text-sub">{sub_txt}</div>
                </div>
            </div>
            """, unsafe_allow_html=True)

            table_html = "<div class='table-wrapper'><table class='risk-table'><thead><tr><th>–£–ì–†–û–ó–ê</th><th>–Æ–†–ò–î–ò–ß–ï–°–ö–ê–Ø –ë–ê–ó–ê –ò –°–£–î–ï–ë–ù–ê–Ø –ü–†–ê–ö–¢–ò–ö–ê</th><th>–ê–õ–ì–û–†–ò–¢–ú –ó–ê–©–ò–¢–´</th></tr></thead><tbody>"
            for i in res.items:
                table_html += f"<tr><td><b>{i.what}</b></td><td>{i.law}</td><td>{i.fix}</td></tr>"
            table_html += "</tbody></table></div>"
            st.markdown(table_html, unsafe_allow_html=True)
            
    st.markdown('</div>', unsafe_allow_html=True)

    st.markdown("""
        <div class="footer-disclaimer">
            ‚ö†Ô∏è <b>–ü–†–ê–í–û–í–û–ï –£–í–ï–î–û–ú–õ–ï–ù–ò–ï:</b> –î–∞–Ω–Ω—ã–π –∞—É–¥–∏—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–æ–π –º–æ–¥–µ–ª—å—é –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∫–æ—Ä–∏–Ω–≥–∞ –º–∞—Ä–∫–µ—Ä–æ–≤ —Ä–∏—Å–∫–∞.<br>
            –û—Ç—á–µ—Ç –Ω–æ—Å–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ-–∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –∏ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º –ø—Ä–∞–≤–æ–≤—ã–º –∑–∞–∫–ª—é—á–µ–Ω–∏–µ–º. –î–ª—è 100% –≥–∞—Ä–∞–Ω—Ç–∏–∏ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –ø—Ä–æ—Ñ–∏–ª—å–Ω—ã–º —é—Ä–∏—Å—Ç–∞–º.
        </div>
    """, unsafe_allow_html=True)

if __name__ == "__main__":
    main()
